<?phpchdir('/var/www/TubeKit/backbone');	ini_set("memory_limit","100M");	require_once("config.php");	require_once("../".$mpdirectory."/rss_fetch.inc");//TubeKit/first/collectOnce.php,, TubeKit/tools/magpierss-0.72 .	require_once("parseRSS.php");	$time = 1.0;// MASATO MADE.	$t=getdate();        $today=date('Y-m-d',$t[0]);	$oTableName = "todaykeryword";	$sql = "SHOW TABLES FROM backbone";	$result = mysql_query($sql);	echo "which table do you want to use as keyword? Select the number.\n";	$number = 0;	$table = array();	while ($row = mysql_fetch_row($result)) {	    echo ($number.": {$row[0]}\n");	    $table[$number] = $row[0];            $number++;	}        $input = (int) fgets(STDIN,4096);        $num = (int) $input;	$newtable = $table[$input]. "_vd_infmtn_50";//        $query2 = "create table $newtable ( id INT NOT NULL AUTO_INCREMENT,PRIMARY KEY(id),original_video_name varchar(100),keyword varchar(100),picked_video varchar(100),view_count integer(15), videoID varchar(11),timestamp int(11))";	$vresult2 = mysql_query($query2) or die(" ". mysql_error());	$query = "SELECT * FROM 2011_10_07_17_30_24_query_mst_vwd_tdy";	$vresult = mysql_query($query) or die(" ". mysql_error());	while ($line = mysql_fetch_array($vresult, MYSQL_ASSOC)) //Returns an array of strings that corresponds to the fetched row	{	    $originalvideo = $line['name'];            $v2 = $line['keyword'];	    echo($v2."\n");		    $vquery = urlencode($v2);	    $qid = $line['id'];		$numvideos = 50;			$maxIndex = $numvideos-49;		for ($index=1; $index<=$maxIndex; $index+=50)//index=1,11,21..		{			$url = "http://gdata.youtube.com/feeds/api/videos/-/$vquery?max-results=50&start-index=$index&v=2";			echo($url."before fetch_rss\n");			$rss = fetch_rss($url);			var_dump($rss);			echo("\n\n\n\n\n");				foreach ($rss->items as $item) 			{				$yt_url = $item['link'];				$ytID = substr($yt_url,31,11);                                $query = "SELECT * from $newtable WHERE keyword='$v2'";                                $result = mysql_query($query) or mysql_error();                                $num_rows = mysql_num_rows($result);				                                if ($num_rows == 0)                                {					$feedURL = "http://gdata.youtube.com/feeds/api/videos/$ytID";					echo($feedURL. "in for each\n");					sleep($time);					if(file_get_contents($feedURL))					{						$time = 0.8 * $time ;						$entry = simplexml_load_file($feedURL);//Convert the well-formed XML document in the given file to an object.						$video = parseVideoEntry($entry);						$timestamp = time();						$title = $video->title;						$description = $video->description;						$username = $video->username;						$upload_time = $video->published;						$duration = $video->length;						$category = $video->category;						$video_url = $video->watchURL;						$thumb_url = 'http://i1.ytimg.com/vi/' . $ytID . '/0.jpg';//echo($thumb_url. "\n");						$keywords = $video->keywords;						$view_count = $video->viewCount;						$rating_count = $video->numrating;						$rating_avg = $video->rating;						$comment_count = $video->comentsCount;						$favorited = $video->favoriteCount;							$response_count = $video->responseCount;												$q = "insert into $newtable VALUES ('','$originalvideo','$v2','$title','$view_count','$ytID','$timestamp')";                                                echo($q. "insertquery\n");//                                                $r = mysql_query($q) or mysql_error();					}else{					$time = $time + 5.0;					echo("failed\n");					}//if(file_get_contents($feedURL))				}else{   					while ($line = mysql_fetch_array($result, MYSQL_ASSOC)){					      $title = $line['picked_video'];					      $view_count = $line['view_count'];					      $ytID = $line['videoID'];					      $timestamp = $line['timestamp'];					      $q = "insert into $newtable VALUES ('','$originalvideo','$v2','$title','$view_count','$ytID','$timestamp')";                                              echo($q. "insertquery\n");//                                              $r = mysql_query($q) or mysql_error();					}//while($line = mysql_fetch_array($result, MYSQL_ASSOC))								}//if($num_rows == 0)			} // foreach ($rss->items as $item) 		} // for ($index=1; $index<=51; $index+=50)	}		 ?>